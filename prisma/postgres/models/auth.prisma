// 使用者角色枚舉
enum UserRole {
  USER // 一般使用者
  ADMIN // 系統管理員（可維護商店與菜單）
  MODERATOR // 管理者
}

model User {
  id    String @id @default(uuid())
  name  String // 顯示名稱/使用者名稱
  email String @unique // 改為必填，用於登入
  note  String?

  // 認證相關欄位
  password_hash       String // 改為必填，bcrypt 加密密碼
  email_verified      Boolean   @default(false) // Email 驗證狀態
  email_verify_token  String? // Email 驗證 token
  reset_token         String? // 密碼重設 token
  reset_token_expires DateTime? // 重設 token 過期時間

  role      UserRole @default(USER) // 使用者角色
  is_active Boolean  @default(true) // 是否啟用

  // 使用者偏好設定
  preferred_theme String @default("light") // 偏好主題

  // 審計欄位
  created_at  DateTime  @default(now()) // 建立時間
  updated_at  DateTime  @updatedAt // 更新時間
  last_login  DateTime? // 最後登入時間
  login_count Int       @default(0) // 登入次數

  // 關聯
  joinedEvents LunchEvent[] @relation("LunchEventAttendees")
  ownedEvents  LunchEvent[] @relation("LunchEventOwner")
  orders       LunchOrder[]

  @@map("users")
}